services:
  backend-SQLite:
    container_name: backend-SQLite
    build:
      context:      ./containers/backend-SQLite
    env_file:       .env
    restart:        always
      
    networks:       [transcendence]
    depends_on:     [Node_js]
    volumes:        [backend-SQLite-data:/var/www/html]

  blockchain:
    container_name: blockchain
    build:
      context:      ./containers/blockchain
    env_file:       .env
    restart:        always
      
    networks:       [transcendence]
    depends_on:     [backend-SQLite]
    volumes:        [blockchain-data:/var/www/html]

  frontend:
    container_name: frontend
    build:
      context:      ./containers/frontend
    env_file:       .env
    restart:        always
      
    networks:       [transcendence]
    depends_on:     [WAF]
    volumes:        [frontend-data:/var/www/html]

  Node_js:
    container_name: Node_js
    build:
      context:      ./containers/Node_js
    env_file:       .env
    restart:        always
      
    networks:       [transcendence]
    depends_on:     [frontend]
    volumes:        [Node_js-data:/var/www/html]

  WAF:
    container_name: WAF
    build:
      context:      ./containers/WAF
    env_file:       .env
    restart:        on-failure

    ports:          [443:443]
    networks:       [transcendence]
    volumes:        [WAF-data:/var/www/html]


volumes:
  backend-SQLite-data:
    driver:         local
    driver_opts:
      type:         none
      device:       ./volumes/backend-SQLite
      o:            bind

  blockchain-data:
    driver:         local
    driver_opts:
      type:         none
      device:       ./volumes/blockchain
      o:            bind

  frontend-data:
    driver:         local
    driver_opts:
      type:         none
      device:       ./volumes/frontend
      o:            bind

  Node_js-data:
    driver:         local
    driver_opts:
      type:         none
      device:       ./volumes/Node.js
      o:            bind

  WAF-data:
    driver:         local
    driver_opts:
      type:         none
      device:       ./volumes/WAF
      o:            bind


networks:
  transcendence:
    driver: bridge